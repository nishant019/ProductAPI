<!DOCTYPE html>
<html>

<head>
    <title>Update Product</title>
</head>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

<body>
    <div id="menu"></div>

    <p id="success"></p>

    <form id="updateProds" method="post">
        <label for="prodName">Product Name:</label>
        <input type="text" id="prodName" name="prodName">
        <br>
        <label for="prodLocation">Location:</label>
        <input type="text" id="prodLocation" name="prodLocation">
        <br>
        <label for="prodLocation1">Location 1:</label>
        <input type="text" id="prodLocation1" name="prodLocation1">
        <br>
        <label for="prodLocation2">Location 2:</label>
        <input type="text" id="prodLocation2" name="prodLocation2">
        <br>
        <label for="prodImage">Image URL:</label>
        <input type="text" id="prodImage" name="prodImage">
        <br>
        <label for="prodTitle">Title:</label>
        <input type="text" id="prodTitle" name="prodTitle">
        <br>
        <label for="prodDescription">Description:</label>
        <textarea id="prodDescription" name="prodDescription"></textarea>
        <br>
        <p id="error"></p>
        <input type="submit" id="updateProductButton" value="Update Product">
    </form>
    <button id="uploadImage" href="">Upload Image</button>


    <script type="text/javascript" src="/loggedIn.js"></script>
    <script type="text/javascript" src="/menu.js"></script>

    <script>
        // Accessing form elements
        const prodName = document.getElementById('prodName');
        const prodLocation = document.getElementById('prodLocation');
        const prodLocation1 = document.getElementById('prodLocation1');
        const prodLocation2 = document.getElementById('prodLocation2');
        const prodImage = document.getElementById('prodImage');
        const prodTitle = document.getElementById('prodTitle');
        const prodDescription = document.getElementById('prodDescription');

        // Extracting URL parameters and populating form fields
        const loco = new URL(window.location.href);
        document.addEventListener("DOMContentLoaded", function () {
            prodName.value = loco.searchParams.get("prodName");
            prodLocation.value = loco.searchParams.get("prodLocation");
            prodLocation1.value = loco.searchParams.get("prodLocation1");
            prodLocation2.value = loco.searchParams.get("prodLocation2");
            prodImage.value = loco.searchParams.get("prodImage");
            prodTitle.value = loco.searchParams.get("prodTitle");
            prodDescription.value = loco.searchParams.get("prodDescription");
        });

        // Add event listener for updating product
        document.getElementById('updateProductButton').addEventListener('click', function (e) {
            e.preventDefault();
            const data = {
                "prodName": prodName.value,
                "prodLocation": prodLocation.value,
                "prodLocation1": prodLocation1.value,
                "prodLocation2": prodLocation2.value,
                "prodImage": prodImage.value,
                "prodTitle": prodTitle.value,
                "prodDescription": prodDescription.value
            };
            updateProds(data);
        });

        uploadImageButton(loco.searchParams.get("prodId"))
    </script>
</body>

</html>