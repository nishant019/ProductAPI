<!DOCTYPE html>
<html>

<head>
    <title>Change Password</title>
</head>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

<body>
    <h1>Welcome, User!</h1>
    <div id="menu"></div>

    <pre id="profile"></pre>
    <form id="changePasswordForm">
        <label for="oldPassword">Old Password:</label>
        <input type="password" id="oldPassword" name="oldPassword" required>
        <br>
        <label for="password">New Password:</label>
        <input type="password" id="password" name="password" required>
        <br>
        <label for="confirmPassword">Confirm New Password:</label>
        <input type="password" id="confirmPassword" name="confirmPassword" required>
        <br>
        <button id="chPwd" type="submit">Change Password</button>
    </form>
    <pre id="error"></pre>

    <script type="text/javascript" src="/loggedin.js"></script>
    <script type="text/javascript" src="/menu.js">  </script>

    <script>
        const chPwd = document.getElementById('chPwd');

        // Add an event listener to the form to call the changePassword function
        chPwd.addEventListener('click', function (e) {
            e.preventDefault();
            const oldPassword = document.getElementById('oldPassword').value;
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            const data = { "oldPassword": oldPassword, "password": password, "confirmPassword": confirmPassword };
            console.log(data.oldPassword, data.password)
            if (oldPassword === password) {
                errorMsg.style.color = 'red';
                errorMsg.innerHTML = 'New password cannot be the same as the old password';
                setTimeout(() => {
                    errorMsg.style.color = 'black';
                    errorMsg.innerHTML = '';
                }, 3000);
            } else {
                changePassword(data).then(e => {
                    oldPassword = '';
                    confirmPassword = '';
                    password = '';
                });

            }
        });
    
    </script>
</body>

</html>